"use strict";var config={role:localStorage.userRole||"",power:localStorage.power||"",saleId:yo.getQueryString("saleId"),dfSaleId:yo.getQueryString("dfSaleId"),dfSaleName:decodeURIComponent(yo.getQueryString("dfSaleName"))||"",saleName:decodeURIComponent(yo.getQueryString("saleName"))||"",startTime:yo.getQueryString("startTime")||"",endTime:yo.getQueryString("endTime")||"",api_showDetail:"/saleCustomer/showSaleCustomer"};window.app=new Vue({el:"#app",data:{role:config.role,power:config.power,c:[]},created:function(){document.getElementById("app").classList.remove("hide")},mounted:function(){$(document).on("mouseenter",".showTips",function(){var e=$(this).find("i").text();layer.yoTips('<span style="color:#337ab7">'+e+"</span>",this,{tips:[2,"#fff"],time:6e3})}),$(".date-picker").datepicker({autoclose:!0,todayHighlight:!0}),$("#startTime").val(config.startTime),$("#endTime").val(config.endTime),$("#startTime").val()&&$("#endTime").datepicker("setStartDate",new Date($("#startTime").val())),$("#endTime").val()&&$("#startTime").datepicker("setEndDate",new Date($("#endTime").val())),$("#startTime").datepicker({}).on("changeDate",function(e){e.date?$("#endTime").datepicker("setStartDate",new Date(e.date.valueOf())):$("#endTime").datepicker("setStartDate",null)}),$("#endTime").datepicker({}).on("changeDate",function(e){e.date?$("#startTime").datepicker("setEndDate",new Date(e.date.valueOf())):$("#startTime").datepicker("setEndDate",new Date)});var a="";"经理"==config.role?($("#saleId").html('"<option value="'+config.saleId+'">'+config.saleName+'</option>"'),a="7d2f882f13ea48e0a4c8acaeea53b3a5,30b1487221464d369ca4c2462ccca920,01dc6d29f1704efeab0376d327f47d98,90564dd8b75a4f6d815ce418462d401c,e350acd05a6244c79136616302b7dfd6,b729e9334ad64c15a4e47d88b8c2638f,008615f04f39499fb73e5f323add988a,6f247fed28e94194ac66020e55957496,28f1842e2463492a9eb6ddf0def91658,73340766cf3d43af91daff3128adad84,b62d6d19bed64ee199f2c1a5b252b57b"):"电销主管"==config.role&&($("#saleId").html('"<option value="'+config.saleId+'">'+config.saleName+'</option>"'),a="7d2f882f13ea48e0a4c8acaeea53b3a5,30b1487221464d369ca4c2462ccca920,01dc6d29f1704efeab0376d327f47d98"),$("#saleId").select2({placeholder:"请选择销售",language:"zh-CN",allowClear:1,ajax:{url:"/user/getUserInfo",dataType:"json",type:"post",delay:250,data:function(e){return{page:e.page||1,ROLE_ID:a,data:{q:e.term||""}}},processResults:function(e,a){return a.page=a.page||1,$.each(e,function(){this.id=this.USER_ID,this.text=this.NAME}),{results:e,pagination:{more:10==e.length}}},cache:!0},minimumInputLength:0}),this.getData()},methods:{loading:function(e){"close"==e?layer.close(this.loadingSwitch):this.loadingSwitch=layer.load(3)},getData:function(a){$("body,html").scrollTop(0),a&&(this.c.pageNum=a);var t=this;t.loading();var e={startTime:$("[name=startTime]").val(),endTime:$("[name=endTime]").val(),type:99,pageSize:t.c.pageSize||10,pageNo:t.c.pageNum||1,tDfsaleId:config.dfSaleId};config.dfSaleId?e.dfSaleId=$("#saleId").val():e.saleId=$("#saleId").val(),"电销主管"==config.role&&(e.tDfsaleId=$("#saleId").val(),e.dfSaleId="",e.saleId=""),console.log(e),$.ajax({url:config.api_showDetail,async:!1,data:e,success:function(e){t.loading("close"),"00"==e.error?(t.c=e.result,t.pagi?($(".pagi").pagination("updatePages",t.c.pages),1==a&&$(".pagi").pagination("goToPage",t.c.pageNum)):t.pagi=$(".pagi").pagination({pages:t.c.pages,showCtrl:!0,displayPage:6,currentPage:t.c.pageNum,onSelect:function(e){t.c.pageNum=e,t.getData(),yo.scrollTo("body")}})):layer.msg(e.msg)}})},openSalerList:function(e){salerList(e)},viewCustomer:function(e){layer.open({type:2,title:"客户详情",content:"/static/page/customer_detail.html?id="+e,area:["100%","100%"]})},personId:function(){var e=localStorage.getItem("userInfo");return(e=$.parseJSON(e)).list[0].USER_ID}}});