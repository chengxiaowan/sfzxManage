"use strict";var config={isKhGh:yo.getQueryString("isKhGh")||0,role:localStorage.userRole,api_detail:"/mainIndex/showYzjbDetatil",time:yo.getQueryString("time"),id:yo.getQueryString("id"),saleName:yo.getQueryString("saleName"),api_user:"/user/getUserInfo"};"销售精英"!=config.role&&"经理"!=config.role||(config.isKhGh=4);var app={},option=null;option={title:{text:"",textStyle:{color:"#3a3a3a",fontStyle:"normal",fontSize:16}},tooltip:{trigger:"axis"},legend:{data:["商务顾问业绩目标完成情况"]},xAxis:{type:"category",data:[]},yAxis:{type:"value",max:""},series:[{data:[],type:"line",symbol:"circle",symbolSize:6,areaStyle:{normal:{color:new echarts.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#d9ebfd"},{offset:.5,color:"#f6fafe"},{offset:.8,color:"#ffffff"}])}},itemStyle:{normal:{color:"#459df5"}}}]};var pieChartOption={title:{},toolbox:{show:!1,feature:{restore:{show:!1},saveAsImage:{show:!1}}},tooltip:{formatter:"{a} <br/>{b} : {c}%"},series:[{name:"签约客户数",center:["50%","60%"],radius:"90%",axisLine:{lineStyle:{color:[[.3,"#ff878e"],[.8,"#ffce89"],[1,"#5bd4d1"]],width:10}},axisTick:{length:15,lineStyle:{color:"auto"}},splitLine:{length:20,lineStyle:{color:"auto"}},pointer:{width:3},type:"gauge",z:3,min:0,max:220,splitNumber:10,detail:{formatter:"{value}%"},data:[{value:45,name:"签约客户数",label:{textStyle:{fontSize:16}}}]}]};require(["select2"],function(e){window.app=new Vue({el:"#app",data:{dxmonth:config.time,dx:{dkje:"",mbdkje:"",list:[],gxtime:""},saleId:config.id,listId:[]},watch:{dxmonth:function(e){this.getYjmb()},saleId:function(e){this.getYjmb()}},computed:{},created:function(){document.getElementById("app").classList.remove("hide")},mounted:function(){var i=this;laydate.render({elem:"#dxmonth",type:"year",done:function(e,t){i.dxmonth=e}}),this.getYjmb(),this.getUser()},methods:{loading:function(e){"close"==e?layer.close(this.loadingSwitch):this.loadingSwitch=layer.load(3)},getUser:function(){var t=this;t.loading(),$.ajax({type:"post",url:config.api_user,async:!0,data:{ROLE_ID:"02178e62f17b4926bb7014f3ad5a1ebe"},success:function(e){t.loading("close"),t.listId=e}})},getYjmb:function(){var d,c,u=this,e=u.dxmonth+"-04-01",t=Number(u.dxmonth)+1+"-03-31";$.ajax({type:"post",url:config.api_detail,async:!0,data:{startTime:e,endTime:t,runnerId:u.saleId},success:function(i){if(u.loading("close"),"00"==i.error){for(var e=[],t=[],a=0,o=0,n=0;n<i.result.length;n++){var l=i.result[n];a+=Number(i.result[n].dkje),o+=Number(i.result[n].mbdkje),e.push(l.time),t.push(l.dkje)}u.dx.dkje=a,u.dx.mbdkje=o,"Infinity"==(d=Math.round(a/o*1e4)/100)?d=100:isNaN(d)&&(d=0),100<=d&&(d=100),c=d+"%",u.dxhx(d,c);var r=Number(Math.max.apply(null,t));r+=.2*r;var s=echarts.init(document.getElementById("main"));option.xAxis.data=e,option.yAxis.max=Math.ceil(r),option.series[0].data=t,s.setOption(option),s.off("click"),s.on("click",function(e){var t="/static/page/index/saler_yunzuo_list.html?gxtime="+i.result[e.dataIndex].time+"&saleId="+u.saleId;layer.open({type:2,title:"运作到款金额明细",content:t,area:["100%","100%"]})})}else layer.msg(i.msg)}})},dxhx:function(e,t){var i=this;pieChartOption.series[0].max="100",pieChartOption.series[0].data[0].value=e;var a=document.getElementById("pie"),o=echarts.init(a);o.setOption(pieChartOption),o.off("click"),o.on("click",function(e){var t="/static/page/index/saler_yunzuo_list1.html?gxtime="+i.dxmonth+"&saleId="+i.saleId;layer.open({type:2,title:"运作到款金额明细",content:t,area:["100%","100%"]})})},nowMonth:function(){var e=new Date,t=e.getFullYear(),i=e.getMonth()+1;return i=i<10?"0"+i:i,t.toString()+"-"+i.toString()}}})}),window.parentFnc=function(e){layer.closeAll(),window.app.getCaseRecord(window.app.type)};