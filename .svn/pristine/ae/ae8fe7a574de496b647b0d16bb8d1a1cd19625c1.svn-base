{"version":3,"sources":["report_month_edit.js"],"names":["config","mode","yo","getQueryString","userRole","role","localStorage","reportId","window","app","Vue","el","c","jdjdmb","sjwc","sjrate","yjja","Date","getFullYear","month","getMonth","year","parse","userInfo","list","NAME","userName","thisMonth_yjsr","nextMonth_yjsr","nextMonth_hkje","computed","computed_jhrate","this","toFixed","computed_sjrate","thisMonth_hkje","syhkygje","created","that","document","getElementById","classList","remove","loading","api_getMonthData","ajax","url","async","id","$","extend","res","result","success","rq","split","data","zqr","zwr","hkje","yjsr","i","jhnwzd","length","Number","yjdata","yjrq","yjzqr","yjzwr","yjhkje","yjyjsr","yjndfx","ndfx","nextMonth","find","prop","methods","s","layer","close","loadingSwitch","load","save","status","join","innerHTML","title","post","jhrate","api_saveMonthData","parent","error","closeAll","msg","edit","params","getCaseRecord","type"],"mappings":"YAAA,IAAMA,SACFC,KAAMC,GAAGC,eAAe,QADtBH,KAAAA,aAASI,SACXH,SAASE,GAAAA,eAAe,MACxBE,iBAAMC,yBACNC,kBAAaJ,uBAHFK,QAAfC,IAAA,GAAAC,MAUIC,GAAI,OADRH,MACQI,GACEC,OAAA,GACCC,KAAA,GACCD,OAAQ,GACRC,IAAAA,GACAC,KAAAA,IAEAC,MAAAA,GAAMC,OAAAC,cALPC,OADD,GAAAF,OAAAG,WAAA,EAQFC,SAAUJ,KAAJK,MAAWJ,aARfK,UAAAC,KAAA,GAAAC,KASFN,eAAO,EACPO,eAAgBJ,EAEhBK,eAAgB,EAGhBC,eAAgB,EADhBC,aACAD,cAKJE,UAtBiBC,gBAsBR,WAATD,OAAS,KAAAE,KAAApB,EAAAE,KAAAkB,KAAApB,EAAAC,QAAA,IAAAoB,QAAA,GAAA,KAEDC,gBAFC,WAAA,OAAA,KAAAF,KAAAG,eAAAH,KAAApB,EAAAwB,UAAA,IAAAH,QAAA,GAAA,MAMJI,QArCT,WASqB,GAAAC,GAAAN,IAAAO,UAAAC,eA8BP,OAAAC,UAAAC,OAAA,QACNJ,EAAMA,UACAC,EAASC,MACfF,IAAKK,OAALC,iBACSC,OAAK,EACVC,MACAC,GAAO/C,OAFGO,UAINyC,QAAGhD,SAAOO,GAJJ+B,EAAA1B,EAAAqC,EAAAC,UAAAZ,EAAA1B,EAAAuC,EAAAC,QAMVC,EAASD,OAAA1B,WAAUyB,EAAKzB,SAAAyB,EAAAC,OAAA1B,UACpBY,SAASW,eAAaX,OAAQa,UAA9BT,OAAA,QACAJ,EAAGa,QAAIC,QACPb,IAASC,MACJG,EAAQL,EAAb1B,EAAA0C,GAAAC,MAAA,SACUC,EAANlB,EAAA1B,EAAA6C,IAAAF,MAAA,SACWjB,EAAOgB,EAAGC,EAAAA,IAAMA,MAA3B,SACYjB,EAAOmB,EAAIF,EAAAA,KAAMA,MAA7B,SACYjB,EAAOoB,EAAIH,EAAAA,KAAMA,MAA7B,SACMI,EAAcA,EAAKJ,EAAAA,OAAMA,MAA/B,SACMK,EAAOtB,CAETuB,IADEC,EAAAA,OAAN,IAA6BP,GAAdjB,EAAOwB,QAAa,IAANP,EAAM,IAAnCD,EAAAS,OAAAT,EAAAS,OAAA,EACIF,EAAJE,OAAA,CACGA,IAAHF,EAAaP,EAAGS,EAAAA,EAAHA,OAAcT,IACrBS,EAANF,MACAL,EAASK,GAAGA,GAAIP,EAAGS,GACfP,EAAKK,GAALJ,IAAAA,EAAAI,GACAL,EAAKK,GAAGP,IAAKA,EAAbO,GACAL,EAAKK,GAAGJ,KAAMA,EAAdI,GACAL,EAAKK,GAAGH,KAAMA,EAAdG,GACAL,EAAKK,GAAGF,OAAOA,EAAfE,GACAL,EAAKK,gBAALG,OAAAL,EAAAE,IACAL,EAAKK,gBAAYC,OAAjBF,EAAAC,GAEAvB,GAAAA,GAAKX,KAAAA,EAAAA,UAAkBqC,GAG1B,GAAAC,MAGSC,EAAO5B,EAAK1B,EAAEsD,KAAKX,MAAM,SADhBY,EAAf7B,EAAA1B,EAAAuD,MAAAZ,MAAA,SACajB,EAAAA,EAAYiB,EAAMa,MAAAb,MAA/B,SACcjB,EAAO6B,EAAMZ,EAAbc,OAAmBd,MAAjC,SACcjB,EAAO8B,EAAMb,EAAbe,OAAmBf,MAAjC,SACMc,IAKL,IAJKC,EAAShC,EAAK1B,QAAL0B,EAAciB,EAAMgB,OAApB,KACJC,EAAXlC,EAAA1B,EAAA2D,OAAAhB,MAAA,UAEIiB,EAAOlC,OAAoB,GAAbiC,EAAOhB,QAArB,IAAAW,EAAA,GAAAA,EAAAH,OAAAG,EAAAH,OAAA,EACHG,EAAAH,OAAA,CAEEG,IADEH,EAAL,EACQA,EAAO,EAAAF,EAAAK,EAAAH,OAAAF,IACfI,EAAAJ,MACKA,EAAOA,GAAIK,GAAKH,EAArBF,GACII,EAAAJ,GAAAJ,IAAAU,EAAAN,GACAI,EAAUX,GAAVI,IAAoBG,EAApBA,GACAI,EAAUR,GAAVE,KAAgBQ,EAAhBN,GACAI,EAAUP,GAAVE,KAAgBQ,EAAhBP,GACAI,EAAUN,GAAVa,KAAiBH,EAAjBR,GACAI,EAAApC,gBAAAmC,OAAAK,EAAAR,IACAI,EAAArC,gBAAAoC,OAAAM,EAAAT,GAEAvB,GAAKV,GAAAA,KAAAA,EAAL6C,UAA8BH,OAI7CtE,OAAAC,MA7DEgD,EAAA,QAAAyB,KAAA,kBAAAC,KAAA,YAAA,IAmEVC,SAOGjC,QA5Ga,SA4GLkC,GACK,SAALA,EAAcC,MAAMC,MAAM/C,KAAKgD,eAPlChD,KAAAgD,cAMMF,MAAAG,KAAA,IAIVC,KAhHY,SAsGRC,GAAAnD,KAAApB,EAAA2D,SAYD,KAAK3D,GAAE2D,GAAP,EAAgBV,EAAhB7B,KAAAyC,UAAAV,OAAAF,IACA7B,KAAKpB,EAAIiD,OAAOA,KAAI7B,KAAKyC,UAAUV,GAAAA,KAElC/B,MAAApB,EAAA2D,OAAAvC,KAAApB,EAAA2D,OAAAa,KAAA,SACDpD,KAAKpB,EAAE2D,OAASY,EAChBnD,KAAKpB,EAAEuE,MAAP5C,SAAAC,eAAA,SAAA6C,UACArD,KAAKpB,EAAE0E,OAAQ/C,KAAAA,OACfU,EAAAsC,KAAOC,OAAPC,kBAAAzD,KAAApB,EAAA,SAAAuC,IACAA,EAAOnD,MAAOyF,OACXC,QAAOC,OAAMb,MAAKc,WACdF,QAAAA,OAAQA,SAAaE,UADzBd,MAGKe,IAAA1C,EAAA0C,QAIXC,KAlIY,SAsGRX,GAAAnD,KAAApB,EAAAoC,GAAAhD,OA6BAmF,SACDnD,KAAKpB,KAALuE,OAURL,OAAAA,UAAA,SAAAiB,GACAjB,MAAAc,WAFJpF,OAAAC,IAAAuF,cAAAxF,OAAAC,IAAAwF","file":"report_month_edit.js","sourcesContent":["const config = {\r\n    mode: yo.getQueryString(\"mode\"),\r\n    role: localStorage.userRole,\r\n    reportId: yo.getQueryString(\"id\"),\r\n    api_getMonthData: '/order/getMonthData.do',//获取当月数据\r\n    api_saveMonthData:'/order/saveMonthData' //保存月报\r\n\r\n}\r\n \r\nwindow.app = new Vue({\r\n    el: '#app',\r\n    data: {\r\n        c: {\r\n            jdjdmb: '', //季度目标\r\n            sjwc: '',//实际完成\r\n            sjrate: '', //完成本月计划百分比\r\n            gbs: \"\",\r\n            yjja: \"\",\r\n        },\r\n        year: new Date().getFullYear(),\r\n        month: new Date().getMonth() + 1,\r\n        userName: (JSON.parse(localStorage.userInfo)).list[0].NAME,\r\n        thisMonth_hkje: 0,  //本月回款金额\r\n        thisMonth_yjsr: 0, //本月佣金收入\r\n\r\n        nextMonth_hkje: 0,  //下月\r\n        nextMonth_yjsr: 0,\r\n        thisMonth:[],\r\n        nextMonth:[]\r\n\r\n    },\r\n    computed:{\r\n        computed_jhrate(){\r\n            return (((this.c.sjwc/this.c.jdjdmb)||0)*100).toFixed(2) + '%'\r\n        },\r\n        computed_sjrate(){\r\n            return (((this.thisMonth_hkje/this.c.syhkygje)||0)*100).toFixed(2) + '%'\r\n        }\r\n    },\r\n    created() {\r\n        const that = this;\r\n              document.getElementById(\"app\").classList.remove(\"hide\")\r\n        that.loading();\r\n               $.ajax({\r\n            url: config.api_getMonthData,\r\n            async: false,\r\n            data:{\r\n                id:config.reportId\r\n            },\r\n            success: function (res) {\r\n                that.c = $.extend({}, that.c, res.result)\r\n                if(res.result.userName) that.userName = res.result.userName\r\n                document.getElementById(\"app\").classList.remove(\"hide\")\r\n                that.loading(\"close\")\r\n                    const data = [];\r\n                    const rq = that.c.rq.split('@bzf@')\r\n                    const zqr = that.c.zqr.split('@bzf@')\r\n                    const zwr = that.c.zwr.split('@bzf@')\r\n                    const hkje = that.c.hkje.split('@bzf@')\r\n                    const yjsr = that.c.yjsr.split('@bzf@')\r\n                    const jhnwzd = that.c.jhnwzd.split('@bzf@')\r\n                    let i = 0\r\n                    rq.length = (rq.length==1&&rq[0]!=\"\")==1 ? rq.length : (rq.length-1)\r\n                    if(rq.length){\r\n                    for (i = 0; i < rq.length; i++) {\r\n                        data[i] = {}\r\n                        data[i].rq = rq[i]\r\n                        data[i].zqr = zqr[i]\r\n                        data[i].zwr = zwr[i]\r\n                        data[i].hkje = hkje[i]\r\n                        data[i].yjsr = yjsr[i]\r\n                        data[i].jhnwzd = jhnwzd[i]\r\n                        that.thisMonth_hkje += Number(hkje[i])\r\n                        that.thisMonth_yjsr += Number(yjsr[i])\r\n                    }\r\n                    if(data[0].rq) that.thisMonth = data\r\n                    }\r\n\r\n                        const yjdata = [];\r\n                        const yjrq = that.c.yjrq.split('@bzf@')\r\n                        const yjzqr = that.c.yjzqr.split('@bzf@')\r\n                        const yjzwr = that.c.yjzwr.split('@bzf@')\r\n                        const yjhkje = that.c.yjhkje.split('@bzf@')\r\n                        const yjyjsr = that.c.yjyjsr.split('@bzf@')\r\n                        let ndfx = [];\r\n                        if(that.c.yjndfx&&that.c.yjndfx[0]){\r\n                            ndfx = that.c.yjndfx.split('@bzf@')\r\n                        }\r\n                        yjrq.length = (yjrq.length==1&&yjrq[0]!=\"\") ? yjrq.length : (yjrq.length-1)\r\n                        if(yjrq.length){\r\n                        i = 0\r\n                        for (i = 0; i < yjrq.length; i++) {\r\n                            yjdata[i] = {}\r\n                            yjdata[i].rq = yjrq[i]\r\n                            yjdata[i].zqr = yjzqr[i]\r\n                            yjdata[i].zwr = yjzwr[i]\r\n                            yjdata[i].hkje = yjhkje[i]\r\n                            yjdata[i].yjsr = yjyjsr[i]\r\n                            yjdata[i].ndfx = ndfx[i]\r\n                            that.nextMonth_hkje += Number(yjhkje[i])\r\n                            that.nextMonth_yjsr += Number(yjyjsr[i])\r\n                        }\r\n                        if(yjdata[0].rq) that.nextMonth = yjdata\r\n                        }\r\n            }\r\n        });\r\n        if (config.mode) {\r\n            $('#app').find('input,textarea').prop(\"readonly\",true)\r\n        }\r\n\r\n    },\r\n    methods: {\r\n        /**\r\n         * 载入中方法\r\n         * \r\n         * @param {string} s 是否关闭\r\n         */\r\n        loading(s) {\r\n            if (s == \"close\") layer.close(this.loadingSwitch)\r\n            else this.loadingSwitch = layer.load(3);\r\n            // else this.loadingSwitch = layer.load(3, { shade: [.6, \"#fff\"] });\r\n        },\r\n        save(status) {\r\n            this.c.yjndfx = []\r\n            for (var i = 0; i < this.nextMonth.length; i++) {\r\n               this.c.yjndfx.push(this.nextMonth[i].ndfx)\r\n            }\r\n            this.c.yjndfx = this.c.yjndfx.join('@bzf@')\r\n            this.c.status = status\r\n            this.c.title = document.getElementById('title').innerHTML\r\n            this.c.jhrate = this.jhrate\r\n            $.post(config.api_saveMonthData,this.c,(res)=>{\r\n               if(res.error=\"00\"){\r\n                   parent&&parent.layer.closeAll()\r\n                   parent&&parent.location.reload()\r\n               }else{\r\n                   layer.msg(res.msg)\r\n               }\r\n            })\r\n        },\r\n        edit(status){\r\n            this.c.id = config.reportId\r\n            this.save(status)       \r\n        }\r\n\r\n    }\r\n})\r\n\r\n\r\n//子页面处理方法\r\nwindow.parentFnc = function (params) {\r\n    layer.closeAll();\r\n    //更新记录\r\n    window.app.getCaseRecord(window.app.type)\r\n}\r\n\r\n\r\n"]}